import{r as d,j as e,m as c}from"./index-zv41U5i8.js";import{D as oe}from"./download--y289ni2.js";function de(){const[m,J]=d.useState(null),[u,K]=d.useState(null),[a,k]=d.useState("dance"),[g,M]=d.useState(!1),[T,Y]=d.useState(!1),[L,C]=d.useState(!1),P=d.useRef(null),I=d.useRef(null),U=d.useRef(null);function D(n,t){const h=n.target.files&&n.target.files[0];if(!h)return;const b=new FileReader;b.onload=f=>{const w=f.target&&f.target.result;t(typeof w=="string"?w:null)},b.readAsDataURL(h)}async function Q(){if(!m||!u){alert("Please upload both faces first");return}Y(!0),M(!1),setTimeout(()=>{Y(!1),M(!0)},800)}async function _(){if(!m||!u){alert("Please upload both faces first");return}if(!g){alert("Please create the video first");return}if(typeof window>"u")return;const n=U.current;if(!n)return;const t=n.getContext("2d");if(!t)return;if(typeof MediaRecorder>"u"||typeof n.captureStream!="function"){alert("Video download is not supported in this browser");return}C(!0);const h=n.captureStream(30),b=[],f=new MediaRecorder(h,{mimeType:"video/webm"});f.ondataavailable=r=>{r.data&&r.data.size>0&&b.push(r.data)};const w=new Promise(r=>{f.onstop=()=>{const i=new Blob(b,{type:"video/webm"}),y=URL.createObjectURL(i),o=document.createElement("a");o.href=y,o.download="love-video.webm",document.body.appendChild(o),o.click(),o.remove(),URL.revokeObjectURL(y),r()}}),R=new Image,S=new Image;R.src=m,S.src=u;function E(r){return new Promise((i,y)=>{if(r.complete&&r.naturalWidth){i();return}r.onload=()=>i(),r.onerror=()=>y(new Error("Failed to load image"))})}try{await Promise.all([E(R),E(S)])}catch{alert("Failed to load images for video"),C(!1),h.getTracks().forEach(r=>r.stop());return}const l=n.width,x=n.height,z=30,te=z*4;let F=0;function A(){const r=F/z,i=t.createLinearGradient(0,0,l,x);a==="dance"?(i.addColorStop(0,"#fee2e2"),i.addColorStop(1,"#f97373")):a==="hearts"?(i.addColorStop(0,"#ffe4e6"),i.addColorStop(1,"#fb7185")):(i.addColorStop(0,"#e0e7ff"),i.addColorStop(1,"#f9a8d4")),t.fillStyle=i,t.fillRect(0,0,l,x);const o=x/2,X=l*.3,$=l*.7,ae=Math.min(l,x)*.16;let V=X,W=$,j=o,N=o,O=1,Z=1,q=0,B=0;if(a==="dance"){const s=Math.sin(r*Math.PI*2);j=o+s*-20,N=o+s*20,q=s*-.25,B=s*.25}else if(a==="hearts"){const s=Math.sin(r*Math.PI*2);j=o+s*-25,N=o+s*25,V=X+s*-l*.03,W=$+s*l*.03}else if(a==="zoom"){const s=Math.sin(r*Math.PI*2),v=1+.08*s;O=v,Z=v,j=o+s*-10,N=o+Math.sin(r*Math.PI*2+Math.PI)*10}function G(s,v,H,re,se){const p=ae*re;t.save(),t.translate(v,H),t.rotate(se),t.beginPath(),t.arc(0,0,p,0,Math.PI*2),t.closePath(),t.clip(),t.drawImage(s,-p,-p,p*2,p*2),t.restore(),t.save(),t.translate(v,H),t.beginPath(),t.arc(0,0,p+8,0,Math.PI*2),t.strokeStyle="rgba(255,255,255,0.9)",t.lineWidth=6,t.stroke(),t.restore()}G(R,V,j,O,q),G(S,W,N,Z,B),t.font="bold 32px system-ui",t.fillStyle="rgba(255,255,255,0.95)",t.textAlign="center",a==="dance"?t.fillText("Dance of Love",l/2,x-40):a==="hearts"?t.fillText("Love Vibes",l/2,x-40):t.fillText("Zoom in Love",l/2,x-40),F+=1,F<te?requestAnimationFrame(A):(f.stop(),h.getTracks().forEach(s=>s.stop()))}f.start(),A(),await w,C(!1)}const ee=a==="dance"?"from-pink-100 to-red-200":a==="hearts"?"from-rose-100 to-pink-200":"from-indigo-100 to-pink-100";return e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:[e.jsx("h1",{className:"text-4xl font-cursive text-love-dark mb-6",children:"Create a Funny Love Video"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Upload two faces and generate a short, looping fun scene."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-lg border border-love-pink/20",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Add your faces (optional)"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{type:"button",onClick:()=>P.current&&P.current.click(),className:"w-full px-3 py-2 rounded-lg border border-gray-300 text-xs font-medium text-gray-700 hover:border-love-red hover:text-love-red transition-colors",children:"Upload you"}),e.jsx("input",{ref:P,type:"file",accept:"image/*",className:"hidden",onChange:n=>D(n,J)}),m&&e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:m,alt:"You",className:"w-16 h-16 rounded-full object-cover border border-love-pink/50"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{type:"button",onClick:()=>I.current&&I.current.click(),className:"w-full px-3 py-2 rounded-lg border border-gray-300 text-xs font-medium text-gray-700 hover:border-love-red hover:text-love-red transition-colors",children:"Upload partner"}),e.jsx("input",{ref:I,type:"file",accept:"image/*",className:"hidden",onChange:n=>D(n,K)}),u&&e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:u,alt:"Partner",className:"w-16 h-16 rounded-full object-cover border border-love-pink/50"})})]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Funny video type"})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:()=>k("dance"),className:`px-3 py-2 rounded-full text-xs font-medium border transition-colors ${a==="dance"?"bg-love-red text-white border-love-red":"bg-white text-gray-700 border-gray-200 hover:border-love-red/60"}`,children:"Dance"}),e.jsx("button",{type:"button",onClick:()=>k("hearts"),className:`px-3 py-2 rounded-full text-xs font-medium border transition-colors ${a==="hearts"?"bg-love-red text-white border-love-red":"bg-white text-gray-700 border-gray-200 hover:border-love-red/60"}`,children:"Hearts"}),e.jsx("button",{type:"button",onClick:()=>k("zoom"),className:`px-3 py-2 rounded-full text-xs font-medium border transition-colors ${a==="zoom"?"bg-love-red text-white border-love-red":"bg-white text-gray-700 border-gray-200 hover:border-love-red/60"}`,children:"Zoom"})]})]}),e.jsx("button",{type:"button",onClick:Q,className:"w-full bg-love-red text-white py-3 rounded-lg font-medium hover:bg-red-700 transition-colors shadow-lg disabled:opacity-60 disabled:cursor-not-allowed",disabled:T,children:T?"Creating...":"Create video"})]})}),e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white p-6 rounded-2xl shadow-lg border border-love-pink/20 flex items-center justify-center",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("h2",{className:"text-3xl font-cursive text-love-dark mb-4 text-center",children:"Preview"}),e.jsxs("div",{className:`relative w-full aspect-video rounded-2xl overflow-hidden shadow-lg bg-gradient-to-br ${ee}`,children:[!g&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-center text-gray-700 px-6",children:[e.jsx("div",{className:"text-5xl mb-3",children:"‚ù§"}),e.jsxs("p",{className:"text-sm",children:["Upload two faces and click ",e.jsx("span",{className:"font-semibold",children:"Create video"})," to see them in a fun scene."]})]}),g&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative w-full h-full",children:[m&&e.jsx(c.img,{src:m,alt:"You video",className:"absolute w-24 h-24 md:w-28 md:h-28 rounded-full object-cover border-4 border-white shadow-lg",initial:{x:-80,y:0,rotate:0},animate:a==="dance"?{y:[-10,10,-10],rotate:[-8,8,-8]}:a==="hearts"?{y:[0,-20,0],x:[-20,0,20]}:{scale:[1,1.1,1],y:[-6,6,-6]},transition:{duration:1.6,repeat:1/0,repeatType:"reverse"},style:{left:"18%",top:"50%",transform:"translate(-50%, -50%)"}}),u&&e.jsx(c.img,{src:u,alt:"Partner video",className:"absolute w-24 h-24 md:w-28 md:h-28 rounded-full object-cover border-4 border-white shadow-lg",initial:{x:80,y:0,rotate:0},animate:a==="dance"?{y:[10,-10,10],rotate:[8,-8,8]}:a==="hearts"?{y:[-10,10,-10],x:[20,0,-20]}:{scale:[1.1,1,1.1],y:[6,-6,6]},transition:{duration:1.6,repeat:1/0,repeatType:"reverse"},style:{right:"18%",top:"50%",transform:"translate(50%, -50%)"}}),a==="dance"&&e.jsxs(c.div,{className:"absolute inset-x-0 bottom-8 flex items-center justify-center text-3xl",animate:{scale:[1,1.2,1]},transition:{duration:1.4,repeat:1/0,repeatType:"reverse"},children:[e.jsx("span",{className:"mx-1",children:"üéµ"}),e.jsx("span",{className:"mx-1",children:"üíÉ"}),e.jsx("span",{className:"mx-1",children:"üé∂"})]}),a==="hearts"&&e.jsxs(e.Fragment,{children:[e.jsx(c.div,{className:"absolute left-6 bottom-6 text-4xl",animate:{y:[0,-12,0]},transition:{duration:1.8,repeat:1/0,repeatType:"reverse"},children:"‚ù§Ô∏è"}),e.jsx(c.div,{className:"absolute right-6 top-6 text-4xl",animate:{y:[-8,8,-8]},transition:{duration:1.8,repeat:1/0,repeatType:"reverse"},children:"üíò"})]}),a==="zoom"&&e.jsx(c.div,{className:"absolute inset-0 flex items-center justify-center text-4xl text-white/90",animate:{opacity:[.7,1,.7]},transition:{duration:2,repeat:1/0,repeatType:"reverse"},children:"üíû"})]})})]}),g&&e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsxs("button",{type:"button",onClick:_,disabled:L,className:"inline-flex items-center gap-2 px-5 py-2.5 rounded-lg bg-love-red text-white font-medium shadow-md hover:bg-red-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:[e.jsx(oe,{className:"h-5 w-5"}),e.jsx("span",{children:L?"Preparing video...":"Download video"})]})})]})})]})]}),e.jsx("canvas",{ref:U,width:640,height:360,className:"hidden"})]})}export{de as default};
