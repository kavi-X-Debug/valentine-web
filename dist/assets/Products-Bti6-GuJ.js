import{c as V,u as B,a as z,b as J,r as a,j as t,m as W,H as X,L as Y,S as ee,d as te,e as H,f as D,g as se,h as re,i as ae,k as oe}from"./index-ydXDGJmK.js";import{M as _}from"./products-ltJaewHY.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=V("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function ne({product:o,isFavorite:c,onToggleFavorite:x}){const{addToCart:h}=B(),{currentUser:f}=z(),j=J(),[p,b]=a.useState(!1);return t.jsxs(W.div,{initial:{opacity:0,y:20,scale:.95},whileInView:{opacity:1,y:0,scale:1},viewport:{once:!0,amount:.2},whileHover:{y:-8,scale:1.02},transition:{duration:.3},className:"bg-white rounded-2xl shadow-sm hover:shadow-lg overflow-hidden border border-love-pink/30 transition-all h-full flex flex-col",children:[t.jsxs("div",{className:"relative aspect-square overflow-hidden",children:[t.jsx("img",{src:o.image,alt:o.name,loading:"lazy",className:"w-full h-full object-cover object-top transition-transform duration-500 hover:scale-110"}),t.jsx("button",{onClick:x,"aria-pressed":!!c,className:"absolute top-3 right-3 p-2 bg-white/80 rounded-full transition-colors",children:t.jsx(X,{className:`h-5 w-5 ${c?"text-love-red":"text-gray-400"}`})})]}),t.jsxs("div",{className:"p-4 sm:p-5 flex flex-col h-full",children:[t.jsx("div",{className:"text-xs text-love-red font-medium mb-1 uppercase tracking-wider",children:o.category}),t.jsx(Y,{to:`/products/${o.id}`,children:t.jsx("h3",{className:"text-sm sm:text-base font-semibold text-gray-800 mb-2 hover:text-love-red transition-colors truncate",children:o.name})}),t.jsxs("div",{className:"flex flex-col mt-auto space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("span",{className:"text-xl font-bold text-love-dark",children:["$",o.price.toFixed(2)]}),t.jsxs("button",{onClick:()=>{if(!f){j("/login");return}b(!0)},className:"flex items-center space-x-1 bg-love-light text-love-red px-3 py-2 rounded-lg hover:bg-love-red hover:text-white transition-colors text-sm font-medium",children:[t.jsx(ee,{className:"h-4 w-4"}),t.jsx("span",{children:"Add"})]})]}),p&&t.jsxs("div",{className:"mt-1 bg-love-light/60 border border-love-pink/40 rounded-lg px-3 py-2 text-xs",children:[t.jsxs("p",{className:"text-gray-700 mb-2",children:['Add "',o.name,'" to your cart?']}),t.jsxs("div",{className:"flex justify-end space-x-2",children:[t.jsx("button",{type:"button",onClick:()=>b(!1),className:"px-2 py-1 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{type:"button",onClick:()=>{h(o),b(!1)},className:"px-2 py-1 rounded-md bg-love-red text-white hover:bg-red-700",children:"Confirm"})]})]})]})]})]})}function ie(o){const c=[...o];for(let x=c.length-1;x>0;x--){const h=Math.floor(Math.random()*(x+1));[c[x],c[h]]=[c[h],c[x]]}return c}function xe(){const[o,c]=a.useState("All"),[x,h]=a.useState(""),[f,j]=a.useState("none"),[p,b]=a.useState(""),[w,E]=a.useState(""),[I,q]=a.useState(!1),[Z,u]=a.useState(1),[N,C]=a.useState([]),{currentUser:m}=z(),[$,ce]=a.useState([]),[S,T]=a.useState(!1),[v,O]=a.useState("none"),[M]=te(),A=a.useMemo(()=>ie(_),[]),k=a.useMemo(()=>{const e=new Set(_.map(r=>r.category));return["All",...Array.from(e)]},[]),L=a.useMemo(()=>{let e=o==="All"?A:A.filter(s=>s.category===o);const r=x.trim().toLowerCase();r&&(e=e.filter(s=>s.name.toLowerCase().includes(r)));let l=p!==""?parseFloat(p):null,n=w!==""?parseFloat(w):null;return v!=="none"&&(v==="under30"?(l=null,n=30):v==="30to50"?(l=30,n=50):v==="50plus"&&(l=50,n=null)),l!==null&&(e=e.filter(s=>s.price>=l)),n!==null&&(e=e.filter(s=>s.price<=n)),$.length>0&&(e=e.filter(s=>s.tags&&s.tags.some(g=>$.includes(g)))),S&&m&&(e=e.filter(s=>N.includes(s.id))),f==="price_asc"?e=[...e].sort((s,g)=>s.price-g.price):f==="price_desc"?e=[...e].sort((s,g)=>g.price-s.price):f==="name_asc"?e=[...e].sort((s,g)=>s.name.localeCompare(g.name)):f==="name_desc"&&(e=[...e].sort((s,g)=>g.name.localeCompare(s.name))),e},[o,x,p,w,f,$,S,v,N,m,A]),P=16,i=Math.max(1,Math.ceil(L.length/P)),d=Math.min(Z,i),R=L.slice((d-1)*P,d*P),F=L.length,U=F===0?0:(d-1)*P+1,G=F===0?0:U+R.length-1;let y=[];i<=5?y=Array.from({length:i},(e,r)=>r+1):d<=3?y=[1,2,3,4,"dots",i]:d>=i-2?y=[1,"dots",i-3,i-2,i-1,i]:y=[1,"dots",d-1,d,d+1,"dots",i],a.useMemo(()=>{const e=new Set;return _.forEach(r=>(r.tags||[]).forEach(l=>e.add(l))),Array.from(e).sort()},[]),a.useEffect(()=>{const e=M.get("category")||M.get("cat");if(!e)return;const r=decodeURIComponent(e).toLowerCase();let l=k.find(n=>n.toLowerCase()===r);l||(l=k.find(n=>n.toLowerCase().includes(r))),l&&l!==o&&(c(l),u(1))},[M,k,o]),a.useEffect(()=>{let e=!0;async function r(){if(!m){e&&C([]);return}try{const l=H(D,"users",m.uid),n=await se(l);if(!e)return;const s=n.exists()?n.data():{};C(Array.isArray(s.favorites)?s.favorites:[])}catch{e&&C([])}}return r(),()=>{e=!1}},[m]);async function K(e){if(!m){alert("Please log in to save favorites");return}const r=N.includes(e),l=H(D,"users",m.uid);try{await re(l,{favorites:r?ae(e):oe(e)}),C(n=>r?n.filter(s=>s!==e):[...n,e])}catch(n){console.error("Failed to update favorites",n)}}function Q(){q(e=>!e)}return t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[t.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-8",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-4xl font-cursive text-love-dark",children:"Shop Gifts"}),t.jsx("p",{className:"text-gray-600 mt-2",children:"Find the perfect token of your affection"})]})}),t.jsx("div",{className:"space-y-6",children:t.jsxs("section",{children:[t.jsx("div",{className:"flex items-center justify-between mb-4",children:t.jsxs("button",{onClick:Q,className:"inline-flex items-center space-x-2 px-3 py-2 rounded-lg bg-white border border-love-pink/30 text-gray-600 hover:text-love-red hover:border-love-red transition-colors","aria-label":"Toggle filters",title:"Filters",children:[t.jsx(le,{className:"h-5 w-5"}),t.jsx("span",{className:"text-sm font-medium",children:"Filters"})]})}),t.jsxs("div",{className:`bg-white p-4 rounded-xl shadow-sm border border-love-pink/20 mb-6 ${I?"block":"hidden"}`,children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[t.jsx("span",{className:"text-sm font-semibold text-love-dark",children:"Filter & Sort"}),t.jsx("button",{type:"button",onClick:()=>{c("All"),h(""),j("none"),b(""),E(""),O("none"),T(!1),u(1)},className:"self-start text-xs px-3 py-1 rounded-full border border-gray-300 text-gray-600 hover:bg-gray-50",children:"Clear all"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[t.jsx("select",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-love-red focus:border-transparent outline-none",value:o,onChange:e=>{c(e.target.value),u(1)},children:k.map(e=>t.jsx("option",{value:e,children:e},e))}),t.jsx("input",{type:"text",placeholder:"Search products...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-love-red focus:border-transparent outline-none",value:x,onChange:e=>{h(e.target.value),u(1)}}),t.jsxs("select",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-love-red focus:border-transparent outline-none",value:f,onChange:e=>{j(e.target.value),u(1)},children:[t.jsx("option",{value:"none",children:"Sort by"}),t.jsx("option",{value:"price_asc",children:"Price: Low to High"}),t.jsx("option",{value:"price_desc",children:"Price: High to Low"}),t.jsx("option",{value:"name_asc",children:"Name: A to Z"}),t.jsx("option",{value:"name_desc",children:"Name: Z to A"})]}),t.jsx("input",{type:"number",min:"0",step:"0.01",placeholder:"Min price",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-love-red focus:border-transparent outline-none",value:p,onChange:e=>{b(e.target.value),u(1)}}),t.jsx("input",{type:"number",min:"0",step:"0.01",placeholder:"Max price",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-love-red focus:border-transparent outline-none",value:w,onChange:e=>{E(e.target.value),u(1)}})]}),t.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Quick Price"}),t.jsx("div",{className:"space-y-2",children:[{id:"none",label:"None"},{id:"under30",label:"Under $30"},{id:"30to50",label:"$30 â€“ $50"},{id:"50plus",label:"$50+"}].map(e=>t.jsx("button",{onClick:()=>{O(e.id),u(1)},className:`w-full text-left px-3 py-2 rounded-lg border text-sm ${v===e.id?"bg-love-red text-white border-love-red":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:e.label},e.id))})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Only Favorites"}),t.jsx("button",{onClick:()=>{T(e=>!e),u(1)},disabled:!m,className:`w-full px-3 py-2 rounded-lg border text-sm ${S?"bg-love-red text-white border-love-red":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"} ${m?"":"opacity-50 cursor-not-allowed"}`,children:S?"Enabled":"Disabled"})]})]})]}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 items-stretch",children:R.map(e=>{const r=N.includes(e.id);return t.jsx(ne,{product:e,isFavorite:r,onToggleFavorite:()=>K(e.id)},e.id)})}),t.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row items-center justify-between gap-4",children:[t.jsx("div",{className:"text-sm text-gray-600",children:F===0?"No gifts found. Try adjusting your filters.":`Showing ${U}-${G} of ${F} gifts`}),i>1&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>u(e=>Math.max(1,e-1)),disabled:d===1,className:`px-3 py-2 rounded-md border text-sm ${d===1?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Previous"}),y.map((e,r)=>e==="dots"?t.jsx("span",{className:"px-2 text-gray-400 text-sm",children:"..."},`dots-${r}`):t.jsx("button",{onClick:()=>u(e),className:`px-3 py-2 rounded-md border text-sm ${e===d?"bg-love-red text-white border-love-red":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:e},e)),t.jsx("button",{onClick:()=>u(e=>Math.min(i,e+1)),disabled:d===i,className:`px-3 py-2 rounded-md border text-sm ${d===i?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Next"})]})]})]})})]})}export{xe as default};
